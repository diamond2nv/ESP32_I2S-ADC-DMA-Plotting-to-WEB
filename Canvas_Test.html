<!DOCTYPE HTML>
<html>
<head>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>      
<script type = "text/javascript" >
window.onload = function () {
	var dataPoints = [];
	var chart = new CanvasJS.Chart("chartContainer", {
			title : {
				text : "Dynamic Data"
			},
			data : [{
					type : "line",
					dataPoints : dataPoints
				}
			]
		});
	chart.render();
    var yVal , xVal = 0;
    var updateCount = 0;
	var updateChart = function () {
        updateCount++;
        dataPoints.push({
        y : yVal,
        x : xVal
    });
    if (dataPoints.length >  500 )
      	{
            dataPoints.shift();
        }     
    chart.options.title.text = "Update " + updateCount;
    chart.render();   
};

webSocket1 = new WebSocket('ws://' + window.location.hostname + ':81/');
webSocket1.onmessage=function(a){
var t = a.data;
if(t.indexOf('}')>-1){
    var l = t.substring(0,t.length-1);
    yVal = parseInt(l,10);
    console.log(yVal);
    xVal++;
    updateChart();
	   }
	};

}	
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/canvasjs/1.7.0/canvasjs.js"></script>
</head>
<body>
<div id = "chartContainer" style = "height: 400px; width: 70%;"></div>
</body>
</html>